<!DOCTYPE html>
<html lang="en" class="h-full bg-gray-50">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LongSlop - AI Story Generator</title>
  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="/frontend/style.css">
</head>
<body class="h-full flex flex-col">

  <header class="border-b bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
      <h1 class="text-2xl font-bold text-gray-800">
        LongSlop AI Story Generator
      </h1>
      <p class="text-sm text-gray-500">Crafted with AI and SSE streaming</p>
    </div>
  </header>

  <main class="flex-grow">

    <div class="max-w-7xl mx-auto px-4 py-6">
      
      <!-- Input Form -->
      <div class="bg-white p-6 rounded-lg shadow-md mb-8">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Generate a New Story</h2>
        <form id="generateForm" class="space-y-4">
          <div>
            <label for="topic" class="block font-medium text-gray-700 mb-2">Topic</label>
            <input type="text" id="topic" name="topic" required class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-indigo-200" placeholder="e.g. A journey through a mystical forest"/>
          </div>
          <div class="flex flex-col md:flex-row md:space-x-4">
            <div class="flex-1">
              <label for="style" class="block font-medium text-gray-700 mb-2">Style</label>
              <select id="style" name="style" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-indigo-200">
                <!-- Options populated by script.js -->
              </select>
            </div>
            <div class="flex-1">
              <label for="length" class="block font-medium text-gray-700 mb-2">Length</label>
              <select id="length" name="length" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-indigo-200">
                <option value="short">Short</option>
                <option value="medium">Medium</option>
                <option value="long">Long</option>
              </select>
            </div>
            <div class="flex-1">
              <label for="includeHeaders" class="block font-medium text-gray-700 mb-2">Include Headers</label>
              <select id="includeHeaders" name="includeHeaders" class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring focus:ring-indigo-200">
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
          </div>
          <div>
            <button type="submit" class="bg-indigo-600 text-white px-4 py-2 rounded font-medium hover:bg-indigo-700 focus:outline-none">
              Generate
            </button>
          </div>
        </form>
      </div>
      
      <!-- Progress and Output Section -->
      <div id="outputSection" class="hidden">
        <div class="bg-white p-6 rounded-lg shadow-md mb-8">
          <h2 class="text-xl font-semibold text-gray-700 mb-4">Generation Progress</h2>
          <div class="mb-4">
            <div id="progressSteps" class="flex flex-col space-y-2 text-gray-700">
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="plan"></span>
                <span>Plan</span>
              </div>
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="outline"></span>
                <span>Outline</span>
              </div>
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="revised_plan"></span>
                <span>Revised Plan</span>
              </div>
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="revised_outline"></span>
                <span>Revised Outline</span>
              </div>
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="article"></span>
                <span>Article</span>
              </div>
              <div class="flex items-center space-x-2">
                <span class="status-icon w-4 h-4 inline-block rounded-full bg-gray-300" data-step="audio"></span>
                <span>Audio</span>
              </div>
            </div>
          </div>
          <div class="text-sm text-gray-500 mb-4" id="statusMessage">Waiting for server response...</div>
          <div id="rawDataToggle" class="mb-4 hidden">
            <button class="text-indigo-600 underline text-sm" onclick="toggleRawData()">Toggle Raw JSON Data</button>
          </div>
          <pre id="rawData" class="hidden text-xs bg-gray-100 p-2 overflow-auto max-h-64 rounded border border-gray-300"></pre>
        </div>

        <div id="finalArticle" class="bg-white p-6 rounded-lg shadow-md mb-8 hidden">
          <h2 class="text-xl font-semibold text-gray-700 mb-4">Final Article</h2>
          <div id="articleContent" class="prose max-w-none"></div>
        </div>

        <div id="audioSection" class="bg-white p-6 rounded-lg shadow-md mb-8 hidden">
          <h2 class="text-xl font-semibold text-gray-700 mb-4">Audio</h2>
          <p>Your article has been converted to audio:</p>
          <audio id="articleAudio" controls class="mt-4 w-full"></audio>
        </div>
      </div>
    </div>
  </main>

  <footer class="bg-white border-t py-4">
    <div class="max-w-7xl mx-auto px-4 text-sm text-gray-500">
      &copy; 2024 LongSlop. All rights reserved.
    </div>
  </footer>

  <script src="/frontend/script.js"></script>
</body>
</html>
